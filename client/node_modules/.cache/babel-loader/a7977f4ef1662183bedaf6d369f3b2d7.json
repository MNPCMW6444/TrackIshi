{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/mnpcm/Documents/GitHub/TrackIshi/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/mnpcm/Documents/GitHub/TrackIshi/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/mnpcm/Documents/GitHub/TrackIshi/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import Axios from\"axios\";import React,{useContext,useState}from\"react\";import{Link,useHistory}from\"react-router-dom\";import UserContext from\"../context/UserContext\";import domain from\"../util/domain\";import ErrorMessage from\"./messages/ErrorMessage\";function Login(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),formMA=_useState2[0],setFormMA=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),formPassword=_useState4[0],setFormPassword=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),errorMessage=_useState6[0],setErrorMessage=_useState6[1];var _useContext=useContext(UserContext),getUser=_useContext.getUser;var history=useHistory();function login(_x){return _login.apply(this,arguments);}function _login(){_login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var loginData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();loginData={MA:formMA,password:formPassword};_context.prev=2;_context.next=5;return Axios.post(\"\".concat(domain,\"/user/login\"),loginData);case 5:_context.next=11;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](2);if(_context.t0.response){if(_context.t0.response.data.errorMessage){setErrorMessage(_context.t0.response.data.errorMessage);}}return _context.abrupt(\"return\");case 11:_context.next=13;return getUser();case 13:history.push(\"/\");case 14:case\"end\":return _context.stop();}}},_callee,null,[[2,7]]);}));return _login.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{className:\"auth-form\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u05DB\\u05E0\\u05D9\\u05E1\\u05D4\"}),errorMessage&&/*#__PURE__*/_jsx(ErrorMessage,{message:errorMessage,clear:function clear(){return setErrorMessage(null);}}),/*#__PURE__*/_jsxs(\"form\",{className:\"form\",onSubmit:login,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"form-ma\",children:\"\\u05DE\\u05E1\\u05E4\\u05E8 \\u05D0\\u05D9\\u05E9\\u05D9\"}),/*#__PURE__*/_jsx(\"input\",{id:\"form-ma\",type:\"number\",value:formMA,onChange:function onChange(e){return setFormMA(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"form-password\",children:\"\\u05E1\\u05D9\\u05E1\\u05DE\\u05D4\"}),/*#__PURE__*/_jsx(\"input\",{id:\"form-password\",type:\"password\",value:formPassword,onChange:function onChange(e){return setFormPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-submit\",type:\"submit\",children:\"\\u05D4\\u05D9\\u05DB\\u05E0\\u05E1\"})]}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u05D0\\u05D9\\u05E0\\u05DA \\u05E7\\u05D9\\u05D9\\u05DD \\u05D1\\u05DE\\u05E2\\u05E8\\u05DB\\u05EA?   \\u05D1\\u05E7\\u05E9 \\u05DE\\u05D4\\u05DE\\u05E4\\u05E7\\u05D3 \\u05DC\\u05D9\\u05E6\\u05D5\\u05E8 \\u05E2\\u05D1\\u05D5\\u05E8\\u05DA \\u05DE\\u05E9\\u05EA\\u05DE\\u05E9\"})]});}export default Login;","map":{"version":3,"sources":["C:/Users/mnpcm/Documents/GitHub/TrackIshi/client/src/components/Login.js"],"names":["Axios","React","useContext","useState","Link","useHistory","UserContext","domain","ErrorMessage","Login","formMA","setFormMA","formPassword","setFormPassword","errorMessage","setErrorMessage","getUser","history","login","e","preventDefault","loginData","MA","password","post","response","data","push","target","value"],"mappings":"0kBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,KAAP,EAAgBC,UAAhB,CAA4BC,QAA5B,KAA4C,OAA5C,CACA,OAASC,IAAT,CAAeC,UAAf,KAAiC,kBAAjC,CACA,MAAOC,CAAAA,WAAP,KAAwB,wBAAxB,CACA,MAAOC,CAAAA,MAAP,KAAmB,gBAAnB,CACA,MAAOC,CAAAA,YAAP,KAAyB,yBAAzB,CAEA,QAASC,CAAAA,KAAT,EAAiB,eACaN,QAAQ,CAAC,EAAD,CADrB,wCACRO,MADQ,eACAC,SADA,8BAEyBR,QAAQ,CAAC,EAAD,CAFjC,yCAERS,YAFQ,eAEMC,eAFN,8BAGyBV,QAAQ,CAAC,IAAD,CAHjC,yCAGRW,YAHQ,eAGMC,eAHN,+BAKKb,UAAU,CAACI,WAAD,CALf,CAKPU,OALO,aAKPA,OALO,CAOf,GAAMC,CAAAA,OAAO,CAAGZ,UAAU,EAA1B,CAPe,QASAa,CAAAA,KATA,2HASf,iBAAqBC,CAArB,gIACEA,CAAC,CAACC,cAAF,GAEMC,SAHR,CAGoB,CAChBC,EAAE,CAAEZ,MADY,CAEhBa,QAAQ,CAAEX,YAFM,CAHpB,uCASUZ,CAAAA,KAAK,CAACwB,IAAN,WAAcjB,MAAd,gBAAmCc,SAAnC,CATV,uFAWI,GAAI,YAAII,QAAR,CAAkB,CAChB,GAAI,YAAIA,QAAJ,CAAaC,IAAb,CAAkBZ,YAAtB,CAAoC,CAClCC,eAAe,CAAC,YAAIU,QAAJ,CAAaC,IAAb,CAAkBZ,YAAnB,CAAf,CACD,CACF,CAfL,gEAmBQE,CAAAA,OAAO,EAnBf,SAoBEC,OAAO,CAACU,IAAR,CAAa,GAAb,EApBF,oEATe,wCAgCf,mBACE,aAAK,SAAS,CAAC,WAAf,wBACE,sDADF,CAEGb,YAAY,eACX,KAAC,YAAD,EACE,OAAO,CAAEA,YADX,CAEE,KAAK,CAAE,uBAAMC,CAAAA,eAAe,CAAC,IAAD,CAArB,EAFT,EAHJ,cAQE,cAAM,SAAS,CAAC,MAAhB,CAAuB,QAAQ,CAAEG,KAAjC,wBACE,cAAO,OAAO,CAAC,SAAf,+DADF,cAEE,cACE,EAAE,CAAC,SADL,CAEE,IAAI,CAAC,QAFP,CAGE,KAAK,CAAER,MAHT,CAIE,QAAQ,CAAE,kBAACS,CAAD,QAAOR,CAAAA,SAAS,CAACQ,CAAC,CAACS,MAAF,CAASC,KAAV,CAAhB,EAJZ,EAFF,cASE,cAAO,OAAO,CAAC,eAAf,4CATF,cAUE,cACE,EAAE,CAAC,eADL,CAEE,IAAI,CAAC,UAFP,CAGE,KAAK,CAAEjB,YAHT,CAIE,QAAQ,CAAE,kBAACO,CAAD,QAAON,CAAAA,eAAe,CAACM,CAAC,CAACS,MAAF,CAASC,KAAV,CAAtB,EAJZ,EAVF,cAiBE,eAAQ,SAAS,CAAC,YAAlB,CAA+B,IAAI,CAAC,QAApC,4CAjBF,GARF,cA6BE,qQA7BF,GADF,CAmCD,CAED,cAAepB,CAAAA,KAAf","sourcesContent":["import Axios from \"axios\";\nimport React, { useContext, useState } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport UserContext from \"../context/UserContext\";\nimport domain from \"../util/domain\";\nimport ErrorMessage from \"./messages/ErrorMessage\";\n\nfunction Login() {\n  const [formMA, setFormMA] = useState(\"\");\n  const [formPassword, setFormPassword] = useState(\"\");\n  const [errorMessage, setErrorMessage] = useState(null);\n\n  const { getUser } = useContext(UserContext);\n    \n  const history = useHistory();\n\n  async function login(e) {\n    e.preventDefault();\n\n    const loginData = {\n      MA: formMA,\n      password: formPassword,\n    };\n\n    try {\n      await Axios.post(`${domain}/user/login`, loginData);\n    } catch (err) {\n      if (err.response) {\n        if (err.response.data.errorMessage) {\n          setErrorMessage(err.response.data.errorMessage);\n        }\n      }\n      return;\n    }\n\n    await getUser();\n    history.push(\"/\");\n  }\n\n  return (\n    <div className=\"auth-form\">\n      <h2>כניסה</h2>\n      {errorMessage && (\n        <ErrorMessage\n          message={errorMessage}\n          clear={() => setErrorMessage(null)}\n        />\n      )}\n      <form className=\"form\" onSubmit={login}>\n        <label htmlFor=\"form-ma\">מספר אישי</label>\n        <input\n          id=\"form-ma\"\n          type=\"number\"\n          value={formMA}\n          onChange={(e) => setFormMA(e.target.value)}\n        />\n\n        <label htmlFor=\"form-password\">סיסמה</label>\n        <input\n          id=\"form-password\"\n          type=\"password\"\n          value={formPassword}\n          onChange={(e) => setFormPassword(e.target.value)}\n        />\n        \n        <button className=\"btn-submit\" type=\"submit\">\n          היכנס\n        </button>\n      </form>\n      <p>\n        אינך קיים במערכת?   בקש מהמפקד ליצור עבורך משתמש\n      </p>\n    </div>\n  );\n}\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}